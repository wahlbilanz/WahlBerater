<ng-container *ngIf="data | async as data">
  <nz-breadcrumb>
    <nz-breadcrumb-item><a routerLink="/" title="Zurück zur Startseite">Start</a></nz-breadcrumb-item>
    <nz-breadcrumb-item><a routerLink="/parties" title="Zur Übersicht der Wahllisten">Wahllisten</a></nz-breadcrumb-item>
    <nz-breadcrumb-item
      ><a [routerLink]="['/parties', data.partyId]" title="Wahlliste {{ data.party?.name }}">{{ data.party?.name }}</a></nz-breadcrumb-item
    >
    <nz-breadcrumb-item
      ><span title="Aktuelle Seite: {{ data.candidate.name }}">{{ data.candidate.name }}</span></nz-breadcrumb-item
    >
  </nz-breadcrumb>

  <div class="candidate-info">
    <img class="picture" src="{{ data.candidate.picture | pictureUrl }}" />
    <h2 class="name">
      {{ data.candidate.name }}
      <p class="party">{{ data.party?.name }}</p>
    </h2>
    <p class="description" [innerHTML]="data.candidate.shortDescription | markdown"></p>

    <div class="social">
      <app-social-links [links]="data.candidate.links" [name]="data.candidate.name"></app-social-links>
    </div>
  </div>

  <div class="candidate-description" [innerHTML]="data.candidate.description | markdown"></div>

  <h3>Standpunkte von {{ data.candidate.name }}</h3>
  <section class="candidate-claims" *ngFor="let category of data.claimPositions">
    <h4>{{ category.category.title }}</h4>

    <nz-collapse class="color-band">
      <nz-collapse-panel
        *ngFor="let claim of category.claims"
        [nzHeader]="claim.claim.title"
        [nzExtra]="voteIcon"
        [style.border-left-color]="category.category.color"
      >
        <p class="small" [innerHTML]="claim.claim.description | markdown" *ngIf="claim.claim.description"></p>
        <p>
          <!-- User Vote -->
          <ng-container *ngIf="getUserVote(claim.claimId) | async as userVote">
            <ng-container *ngIf="userVote > 0">
              Du hast <em>dafür</em> gestimmt{{ userVote >= 2 ? ' und diese These als für dich wichtig markiert' : '' }}.
            </ng-container>
            <ng-container *ngIf="userVote < 0">
              Du hast <em>dagegen</em> gestimmt{{ userVote <= -2 ? ' und diese These als für dich wichtig markiert' : '' }}.
            </ng-container>
            <ng-container *ngIf="userVote == 0"> Du hast hast zu dieser These keine Position bezogen. </ng-container>
            <app-decision-icon [vote]="userVote"></app-decision-icon>
            <br />
          </ng-container>
          <!-- Candidate Vote -->
          <ng-container *ngIf="claim.position.vote > 0">
            {{ data.candidate.name }} stimmt <em>{{ claim.position.vote >= 2 ? 'vehement ' : '' }}dafür</em>.
          </ng-container>
          <ng-container *ngIf="claim.position.vote < 0">
            {{ data.candidate.name }} stimmt <em>{{ claim.position.vote <= -2 ? 'vehement ' : '' }}dagegen</em>.
          </ng-container>
          <ng-container *ngIf="claim.position.vote == 0">
            {{ data.candidate.name }} hat zu dieser These keine Position bezogen.
          </ng-container>
          <app-decision-icon [vote]="claim.position.vote"></app-decision-icon>
        </p>
        <blockquote>
          <p [innerHTML]="claim.position.reason | markdown" *ngIf="claim.position.reason"></p>
        </blockquote>

        <a class="more-info-link" [routerLink]="['/', 'claim', claim.claimId]">Mehr Informationen zu dieser These</a>

        <ng-template #voteIcon>
          <app-decision-icon [vote]="claim.position.vote"></app-decision-icon>
        </ng-template>
      </nz-collapse-panel>
    </nz-collapse>
  </section>
</ng-container>
